<div class="container">
  <h3 class="text-center">Giỏ hàng</h3>

  <% if @cart.empty? %>
    <h5 class="text-center">Giỏ hàng đang rỗng</h5>
  <% else %>
    <div id="cart-table">
      <table class="table">
        <thead>
          <tr>
            <th class="text-center">STT</th>
            <th class="text-center">Ảnh</th>
            <th class="text-center">Tên sản phẩm</th>
            <th class="text-center">Số lượng</th>
            <th class="text-center">Đơn giá</th>
            <th class="text-center">Thành tiền</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @cart.each_with_index do |item, index| %>
            <% book = Book.find(item["book_id"]) %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= link_to image_tag(book.image, class: 'img_book_home ' , alt: book.name_book), detail_path(book), data: { turbolinks: false } %></td>
              <td class="text-center" ><%= book.name_book %></td>
              <td class="text-center">
              
                <div class="row" >
                <div style="display: flex; justify-content: center; align-items:center">
                  <div class="col-4">
                    <%= button_to "-", reduce_quantity_path(book_id: book.id), method: :post, class: "btn btn-sm btn-secondary" %>
                  </div>
                  <div class="col-4 text-center">
                    <%= item['quantity'] %>
                  </div>
                  <div class="col-4">
                    <%= button_to "+", add_quantity_path(book_id: book.id), method: :post, class: "btn btn-sm btn-secondary" %>
                  </div>
                  </div>
                </div>
              </td>
              <td class="text-center">
                <div class="price_info">
                  <div class="price_discount"><%= book.display_price[:discount] %></div>
                  <div>&nbsp VNĐ</div>
                </div>
              </td>
              <td class="text-center"><%= book.display_price[:discount] * item['quantity'] %></td>
              <td class="text-center">
                <%= link_to remove_item_path(book_id: book.id), class: 'btn btn-sm btn-danger' do %>
                  <i class="bi bi-trash">X</i>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <div class="text-right">
        <h5 class="total-price"><strong>Tổng cộng: <%= calculate_total(@cart) %></strong></h5>
        <button class="btn btn-primary">Thanh toán</button>
      </div>
    </div>
  <% end %>
</div>

<style>
  .container {
    max-width: 800px;
    margin: 0 auto;
  }

  h3.text-center {
    margin-top: 30px;
    font-size: 24px;
    text-align: center;
  }

  .table {
    margin-top: 30px;
  }

  .table th {
    font-weight: bold;
  }

  .table td {
    vertical-align: middle;
  }

  .text-center {
    text-align: center;
  }

  .text-right {
    text-align: right;
  }

  .img_book_home {
    max-width: 80px;
    height: auto;
  }

  .btn-secondary {
    background-color: #ccc;
    color: #000;
  }

  .btn-danger {
    background-color: #dc3545;
    color: #fff;
  }

  .btn-primary {
    background-color: #007bff;
    color: #fff;
    margin-top: 20px;
  }

  .btn-primary:hover {
    background-color: #0056b3;
  }
  .btn-sm {
    font-size: 10px;
    width : 100%
    padding: 10px 5px;
  }
</style>
